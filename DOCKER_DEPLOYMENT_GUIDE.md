# Docker Deployment Guide

## Quick Start

```bash
./deploy-local.sh
```

This script:
- Builds or pulls the image
- Creates the container
- Mounts volumes for persistent data
- Prints access URLs

On Raspberry Pi, `deploy-local.sh` uses `docker-compose.pi.yml` (generated by `regenerate-docker-compose-pi.sh`).

## Docker Scripts

```bash
./docker-manage.sh start
./docker-manage.sh stop
./docker-manage.sh restart
./docker-manage.sh status
./docker-manage.sh logs -f
./docker-manage.sh update
```

## Container Names and Images

There are two historical naming schemes:
- **Local scripts**: `event-jukebox` (image `event-jukebox:latest`)
- **Pi Docker setup**: `event-jukebox-pi` (image `ghcr.io/jaredlthompson/event-jukebox:latest`)

To avoid conflicts, use **one** approach at a time. On the Pi, prefer the systemd Docker service (`event-jukebox-docker`) and the `event-jukebox-pi` container.

## Audio Devices in Docker (Pi)
The Pi compose file mounts ALSA devices:
- `/dev/snd` is mounted into the container
- `alsa-utils` is installed in the image

You can check devices from inside the container:
```bash
docker exec -it event-jukebox-pi aplay -l
```

Select the output in Settings (e.g., `hw:CARD=Set,DEV=0`).

## Event Branding
Edit `event-config.json` for titles, labels, and WiFi info. On the Pi, store an override at `/app/data/event-config.json` to persist across container rebuilds.

## Troubleshooting

### Port 3000 already in use
```bash
sudo ss -lptn 'sport = :3000'
```
Stop the process or avoid running both Docker and the legacy `event-jukebox` service at the same time.

### Container stuck in Created
```bash
sudo docker rm -f event-jukebox-pi
sudo systemctl restart event-jukebox-docker
```
